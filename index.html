<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dokumentasi API Lengkap - TheBaxLancer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Code+Pro:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #d1d5db;
        }
        pre, code {
            font-family: 'Source Code Pro', monospace;
        }
        .method-post { background-color: #10b981; color: white; }
        .method-get { background-color: #3b82f6; color: white; }
        .method-put { background-color: #f59e0b; color: white; }
        .method-delete { background-color: #ef4444; color: white; }
        .endpoint-card {
            background-color: #1f2937;
            border: 1px solid #374151;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            scroll-margin-top: 80px; /* Offset for sticky header */
        }
        .token-required::after {
            content: 'Authentication Required';
            background-color: #ef4444;
            color: white;
            padding: 0.15rem 0.5rem;
            font-size: 0.75rem;
            border-radius: 9999px;
            margin-left: 0.75rem;
            font-weight: 500;
        }
    </style>
</head>
<body class="antialiased">

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-72 bg-gray-900 border-r border-gray-700 p-6 fixed h-full hidden lg:block overflow-y-auto">
            <h1 class="text-xl font-bold text-white">TheBaxLancer API</h1>
            <p class="text-sm text-gray-400 mt-1">Dokumentasi Lengkap v1.3</p>
            <nav class="mt-8">
                <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Mulai</h2>
                <ul class="mt-3 space-y-2">
                    <li><a href="#introduction" class="text-gray-400 hover:text-white">Pendahuluan</a></li>
                </ul>

                <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-8">Otentikasi</h2>
                <ul class="mt-3 space-y-2">
                    <li><a href="#auth-register" class="text-gray-400 hover:text-white">Registrasi User</a></li>
                    <li><a href="#auth-login" class="text-gray-400 hover:text-white">Login User</a></li>
                </ul>
                
                <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-8">User</h2>
                <ul class="mt-3 space-y-2">
                    <li><a href="#user-me" class="text-gray-400 hover:text-white">Get Profil & Laporan</a></li>
                    <li><a href="#user-picture" class="text-gray-400 hover:text-white">Update Foto Profil</a></li>
                </ul>

                <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-8">Proyek</h2>
                <ul class="mt-3 space-y-2">
                    <li><a href="#projects-get" class="text-gray-400 hover:text-white">Get Semua Proyek</a></li>
                    <li><a href="#projects-submit" class="text-gray-400 hover:text-white">Submit Pekerjaan</a></li>
                </ul>

                <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-8">Admin</h2>
                <ul class="mt-3 space-y-2">
                    <li><a href="#admin-users-get" class="text-gray-400 hover:text-white">Get Semua User</a></li>
                    <li><a href="#admin-users-edit" class="text-gray-400 hover:text-white">Edit User</a></li>
                    <li><a href="#admin-users-approve" class="text-gray-400 hover:text-white">Approve Registrasi</a></li>
                    <li><a href="#admin-projects-create" class="text-gray-400 hover:text-white">Buat Proyek Baru</a></li>
                    <li><a href="#admin-projects-edit" class="text-gray-400 hover:text-white">Edit Proyek</a></li>
                    <li><a href="#admin-submissions-get-all" class="text-gray-400 hover:text-white">Get Semua Submission</a></li>
                    <li><a href="#admin-submissions-get-one" class="text-gray-400 hover:text-white">Get Detail Submission</a></li>
                    <li><a href="#admin-submissions-approve" class="text-gray-400 hover:text-white">Approve Submission</a></li>
                </ul>

                <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-8">Super Admin</h2>
                <ul class="mt-3 space-y-2">
                    <li><a href="#superadmin-withdrawals-get" class="text-gray-400 hover:text-white">Get Semua Withdrawal</a></li>
                    <li><a href="#superadmin-withdrawals-approve" class="text-gray-400 hover:text-white">Approve Withdrawal</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main id="api-content" class="flex-1 lg:ml-72">
            <div class="p-6 md:p-10">

                <!-- Header with Download Button -->
                <div class="flex justify-between items-center mb-10 sticky top-0 bg-gray-900 bg-opacity-80 backdrop-blur-sm py-4 z-10">
                    <h1 class="text-3xl font-bold text-white">Dokumentasi API Lengkap</h1>
                    <button id="download-btn" class="bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                        Download PDF
                    </button>
                </div>

                <!-- Introduction Section -->
                <section id="introduction" class="mb-16">
                    <h2 class="text-2xl font-semibold border-b border-gray-700 pb-2 text-white">Pendahuluan</h2>
                    <div class="mt-4 space-y-4 text-gray-300">
                        <p>Selamat datang di dokumentasi API TheBaxLancer. API ini memungkinkan Anda untuk berinteraksi dengan layanan kami secara terprogram. API ini dirancang dengan prinsip REST.</p>
                        <p>Base URL untuk semua endpoint adalah: <code class="bg-gray-800 p-1 rounded-md text-sm text-yellow-300">/api</code></p>
                        <p>Semua request dan response body menggunakan format JSON, kecuali untuk endpoint yang mengunggah file. Endpoint yang memerlukan otentikasi harus menyertakan <code class="bg-gray-800 p-1 rounded-md text-sm text-yellow-300">Authorization</code> header dengan format <code class="bg-gray-800 p-1 rounded-md text-sm text-yellow-300">Bearer {TOKEN}</code>.</p>
                    </div>
                </section>

                <!-- Endpoint Sections -->
                <div class="space-y-12">
                    
                    <!-- Otentikasi -->
                    <div>
                        <h3 class="text-xl font-semibold mb-6 text-white border-l-4 border-emerald-500 pl-4">Otentikasi</h3>
                        <div id="auth-register" class="endpoint-card">
                            <div class="flex items-center gap-3">
                                <span class="method-post font-bold text-sm px-2.5 py-1 rounded-md">POST</span>
                                <code class="text-md font-semibold text-gray-200">/auth/register</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mendaftarkan user baru.</p>
                            <h4 class="font-semibold pt-4 text-gray-300">Request Body (application/json):</h4>
                            <pre class="bg-gray-800 text-white p-4 rounded-lg text-sm mt-2"><code>{
    "nama": "Budi Santoso",
    "email": "budi.santoso@example.com",
    "password": "password123",
    "tglLahir": "1995-12-25", // Opsional
    "nomorTelepon": "081234567890", // Opsional
    "kodeReferralUpline": "SAN123BUDXYZ" // Opsional
}</code></pre>
                        </div>
                        <div id="auth-login" class="endpoint-card">
                            <div class="flex items-center gap-3">
                                <span class="method-post font-bold text-sm px-2.5 py-1 rounded-md">POST</span>
                                <code class="text-md font-semibold text-gray-200">/auth/login</code>
                            </div>
                            <p class="text-gray-400 mt-2">Login untuk mendapatkan token JWT.</p>
                        </div>
                    </div>

                    <!-- User -->
                    <div>
                        <h3 class="text-xl font-semibold mb-6 text-white border-l-4 border-blue-500 pl-4">User</h3>
                        <div id="user-me" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-get font-bold text-sm px-2.5 py-1 rounded-md">GET</span>
                                <code class="text-md font-semibold text-gray-200">/users/me</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mendapatkan detail profil dan riwayat (laporan) submission pengguna yang sedang login.</p>
                        </div>
                        <div id="user-picture" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-put font-bold text-sm px-2.5 py-1 rounded-md">PUT</span>
                                <code class="text-md font-semibold text-gray-200">/users/me/picture</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mengganti atau menambahkan foto profil.</p>
                            <h4 class="font-semibold pt-4 text-gray-300">Request Body (multipart/form-data):</h4>
                            <pre class="bg-gray-800 text-white p-4 rounded-lg text-sm mt-2"><code>Key: picture
Value: [File: profile.jpg]</code></pre>
                        </div>
                    </div>
                    
                    <!-- Proyek -->
                    <div>
                        <h3 class="text-xl font-semibold mb-6 text-white border-l-4 border-violet-500 pl-4">Proyek</h3>
                        <div id="projects-get" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-get font-bold text-sm px-2.5 py-1 rounded-md">GET</span>
                                <code class="text-md font-semibold text-gray-200">/projects</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mendapatkan daftar semua proyek yang tersedia untuk dikerjakan.</p>
                        </div>
                        <div id="projects-submit" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-post font-bold text-sm px-2.5 py-1 rounded-md">POST</span>
                                <code class="text-md font-semibold text-gray-200">/projects/{projectId}/submit</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mengirimkan hasil pekerjaan untuk sebuah proyek.</p>
                            <h4 class="font-semibold pt-4 text-gray-300">Request Body (multipart/form-data):</h4>
                            <p class="text-gray-400 mt-2">Key dari setiap field adalah ID dari `projectField` yang bersangkutan.</p>
                            <pre class="bg-gray-800 text-white p-4 rounded-lg text-sm mt-2"><code>// Contoh untuk proyek dengan 2 field:
// 1. Input teks dengan projectFieldId = 15
// 2. Unggahan gambar dengan projectFieldId = 16

Key: 15
Value: "Teks jawaban dari user"

Key: 16
Value: [File: screenshot.png]</code></pre>
                        </div>
                    </div>

                    <!-- Admin -->
                    <div>
                        <h3 class="text-xl font-semibold mb-6 text-white border-l-4 border-amber-500 pl-4">Admin</h3>
                        <div id="admin-users-get" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-get font-bold text-sm px-2.5 py-1 rounded-md">GET</span>
                                <code class="text-md font-semibold text-gray-200">/admin/users</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mendapatkan daftar semua user. Dapat difilter dengan query, contoh: <code class="bg-gray-800 p-1 rounded-md text-sm text-yellow-300">/admin/users?status=PENDING</code>.</p>
                        </div>
                        <div id="admin-users-edit" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-put font-bold text-sm px-2.5 py-1 rounded-md">PUT</span>
                                <code class="text-md font-semibold text-gray-200">/admin/users/{id}</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mengedit data pengguna (termasuk foto).</p>
                             <h4 class="font-semibold pt-4 text-gray-300">Request Body (multipart/form-data):</h4>
                            <pre class="bg-gray-800 text-white p-4 rounded-lg text-sm mt-2"><code>Key: nama, Value: "Nama Baru"
Key: email, Value: "emailbaru@example.com"
Key: role, Value: "ADMIN"
Key: balance, Value: "50000"
Key: picture, Value: [File: new_avatar.jpg] // Opsional</code></pre>
                        </div>
                        <div id="admin-projects-create" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-post font-bold text-sm px-2.5 py-1 rounded-md">POST</span>
                                <code class="text-md font-semibold text-gray-200">/admin/projects</code>
                            </div>
                            <p class="text-gray-400 mt-2">Membuat proyek baru.</p>
                            <h4 class="font-semibold pt-4 text-gray-300">Request Body (application/json):</h4>
                            <pre class="bg-gray-800 text-white p-4 rounded-lg text-sm mt-2"><code>{
    "namaProyek": "Proyek Baru",
    "nilaiProyek": 50000,
    "projectUrl": "https://example.com",
    "iconUrl": "https://url.to/icon.png",
    "fields": [
        { "label": "Nama Lengkap", "fieldType": "TEXT" },
        { "label": "Screenshot", "fieldType": "IMAGE" }
    ]
}</code></pre>
                        </div>
                        <div id="admin-submissions-get-one" class="endpoint-card">
                            <div class="flex items-center gap-3 token-required">
                                <span class="method-get font-bold text-sm px-2.5 py-1 rounded-md">GET</span>
                                <code class="text-md font-semibold text-gray-200">/admin/submissions/{id}</code>
                            </div>
                            <p class="text-gray-400 mt-2">Mendapatkan detail lengkap satu submission untuk direview.</p>
                        </div>
                    </div>

                </div>
            </div>
        </main>
    </div>

    <script>
        document.getElementById('download-btn').addEventListener('click', function() {
            const btn = this;
            const originalText = btn.innerHTML;
            btn.disabled = true;
            btn.innerHTML = 'Mempersiapkan PDF...';

            btn.style.visibility = 'hidden';

            const content = document.getElementById('api-content');
            
            html2canvas(content, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#111827',
                onclone: (document) => {
                    document.body.style.background = '#111827';
                }
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                
                const pdf = new jsPDF({
                    orientation: 'p',
                    unit: 'px',
                    format: [canvas.width, canvas.height]
                });

                pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
                pdf.save('thebaxlancer_api_docs.pdf');

                btn.style.visibility = 'visible';
                btn.disabled = false;
                btn.innerHTML = originalText;
            }).catch(err => {
                console.error("Gagal membuat PDF:", err);
                alert("Gagal membuat PDF. Silakan coba lagi.");
                btn.style.visibility = 'visible';
                btn.disabled = false;
                btn.innerHTML = originalText;
            });
        });
    </script>

</body>
</html>
